import{a as P,S as f,L as I}from"./axios-CdaRIhLA.js";import{r as _,l as D,o as v,c as g,a as e,t as U,m as u,v as p,F as V,n as E,q as N,s as S,p as L,f as R,h as B,b as C,u as M,j as A,k as O}from"./index-D8-JcWOM.js";import{_ as H}from"./plugin-vueexport-helper-DlAUqK2U.js";import{P as j}from"./PaginationComponent-D_Pfqg6H.js";var z={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"payroom",BASE_URL:"/vue2023-week7/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const d=m=>(L("data-v-b6e9f945"),m=m(),R(),m),F={method:"dialog"},J={class:"bg-#212529 p-4 flex justify-between items-center"},q={class:"text-white"},G={class:"grid grid-cols-12 gap-6 p-3"},K={class:"col-span-4"},Q={class:"input-group"},W=d(()=>e("label",{for:"imagUrl",class:"block"},"主要圖片",-1)),X=["src"],Y=d(()=>e("img",{src:"",alt:""},null,-1)),Z=d(()=>e("h4",null,"多圖新增",-1)),ee={class:"flex justify-between mb-2"},te={for:"images-1"},oe=["onClick"],ae={class:"input-group"},le=["onUpdate:modelValue"],ie=["src"],se={action:"/api/thisismycourse2/admin/upload",enctype:"multipart/form-data",method:"post",class:"mt-10"},ne={class:"col-span-8"},de={class:"grid grid-cols-2 gap-col-6 gap-row-4"},re={class:"input-group col-span-2"},ue=d(()=>e("label",{for:"title"},"標題",-1)),ce={class:"input-group"},pe=d(()=>e("label",{for:"category"},"分類",-1)),ve=S('<datalist id="categories" data-v-b6e9f945><option value="策略" data-v-b6e9f945>策略</option><option value="派對" data-v-b6e9f945>派對</option><option value="雙人" data-v-b6e9f945>雙人</option><option value="陣營" data-v-b6e9f945>陣營</option><option value="家庭" data-v-b6e9f945>家庭</option><option value="合作" data-v-b6e9f945>合作</option><option value="劇情" data-v-b6e9f945>劇情</option></datalist>',1),be={class:"input-group"},fe=d(()=>e("label",{for:"unit"},"單位",-1)),_e={class:"input-group"},ge=d(()=>e("label",{for:"origin_price"},"原價",-1)),me={class:"input-group"},he=d(()=>e("label",{for:"price"},"售價",-1)),xe=S('<div class="input-group" data-v-b6e9f945><label for="language" data-v-b6e9f945>語言</label><select name="" id="language" data-v-b6e9f945><option value="繁體中文" data-v-b6e9f945>繁體中文</option><option value="簡體中文" data-v-b6e9f945>簡體中文</option><option value="英文" data-v-b6e9f945>英文</option><option value="其他" data-v-b6e9f945>其他</option></select></div><div class="input-group" data-v-b6e9f945><label for="condition" data-v-b6e9f945>狀況：</label><select name="" id="condition" data-v-b6e9f945><option value="良好" data-v-b6e9f945>良好</option><option value="盒子損傷" data-v-b6e9f945>盒子損傷</option><option value="配件損傷" data-v-b6e9f945>配件損傷</option><option value="受潮" data-v-b6e9f945>受潮</option><option value="缺件" data-v-b6e9f945>缺件</option><option value="其他" data-v-b6e9f945>其他</option></select></div>',2),ye={class:"input-group col-span-2"},we=d(()=>e("label",{for:"description"},"產品敘述",-1)),$e={class:"input-group col-span-2"},Ue=d(()=>e("label",{for:"content"},"說明內容",-1)),ke=d(()=>e("label",{for:"is_enabled"},"是否啟用",-1)),Pe={class:"text-end p-3 border-t border-solid border-#dee2e6"},Ve={__name:"ProductModal",props:["tempProduct","isNew"],setup(m,{expose:y}){const{VITE_URL:w,VITE_PATH:k}=z,c=m,t=_(c.tempProduct),r=_();function h(b){b.target.nodeName==="DIALOG"&&r.value.close()}function $(){t.value.imagesUrl||(t.value.imagesUrl=[]),t.value.imagesUrl[t.value.imagesUrl.length-1]!==""&&t.value.imagesUrl.push("")}function x(b){console.dir(b.target);const o=b.target.files[0];console.log(o);const a=new FormData;a.append("file-to-upload",o),P.post(`${w}/v2/api/${k}/admin/upload`,a).then(n=>{console.log(n.data.imageUrl),$(),t.value.imagesUrl[t.value.imagesUrl.length-1]=n.data.imageUrl}).catch(n=>{console.log(n)})}return D(()=>c.tempProduct,()=>{t.value=c.tempProduct}),y({dialog:r}),(b,o)=>(v(),g("dialog",{ref_key:"dialog",ref:r,class:"max-w-1140px w-100% border-0 rd p-0 backdrop:backdrop-blur-3",onClick:h},[e("form",F,[e("div",J,[e("h3",q,U(m.isNew?"新增產品":"編輯產品"),1),e("button",{type:"button",class:"i-ic:baseline-close p-2 text-white font-size-4 hover:cursor-pointer",onClick:o[0]||(o[0]=a=>r.value.close())})]),e("div",G,[e("div",K,[e("div",Q,[W,u(e("input",{type:"text",placeholder:"請輸入圖片連結","onUpdate:modelValue":o[1]||(o[1]=a=>t.value.imageUrl=a),class:"mb-2"},null,512),[[p,t.value.imageUrl]]),e("img",{src:t.value.imageUrl,alt:""},null,8,X)]),Y,e("div",null,[Z,(v(!0),g(V,null,E(t.value.imagesUrl,(a,n)=>(v(),g("div",{key:a},[e("div",ee,[e("label",te,"圖片網址"+U(n+1),1),e("button",{class:"i-ic:baseline-close font-size-5 opacity-50 hover:cursor-pointer hover:opacity-75",onClick:s=>t.value.imagesUrl.splice(n,1)},null,8,oe)]),e("div",ae,[u(e("input",{type:"text","onUpdate:modelValue":s=>t.value.imagesUrl[n]=s,placeholder:"請輸入圖片網址",class:",b-2"},null,8,le),[[p,t.value.imagesUrl[n]]])]),e("img",{src:a,alt:""},null,8,ie)]))),128)),e("button",{type:"button",class:"inline-block w-100% bg-transparent border-#0d6efd border-solid border-1 rd text-#0d6efd py-1 mb-1",hover:"cursor-pointer bg-#0d6efd text-white",onClick:$}," 新增圖片 "),e("form",se,[e("input",{type:"file",name:"file-to-upload",onChange:x},null,32)])])]),e("div",ne,[e("div",de,[e("div",re,[ue,u(e("input",{type:"text",id:"title",placeholder:"請輸入標題","onUpdate:modelValue":o[2]||(o[2]=a=>t.value.title=a)},null,512),[[p,t.value.title]])]),e("div",ce,[pe,u(e("input",{type:"text",id:"category",placeholder:"請輸入分類",list:"categories",autocomplete:"off","onUpdate:modelValue":o[3]||(o[3]=a=>t.value.category=a)},null,512),[[p,t.value.category]]),ve]),e("div",be,[fe,u(e("input",{type:"text",id:"unit",placeholder:"請輸入單位","onUpdate:modelValue":o[4]||(o[4]=a=>t.value.unit=a)},null,512),[[p,t.value.unit]])]),e("div",_e,[ge,u(e("input",{type:"number",id:"origin_price",placeholder:"請輸入原價",min:"0","onUpdate:modelValue":o[5]||(o[5]=a=>t.value.origin_price=a)},null,512),[[p,t.value.origin_price,void 0,{number:!0}]])]),e("div",me,[he,u(e("input",{type:"number",id:"price",placeholder:"請輸入售價",min:"0","onUpdate:modelValue":o[6]||(o[6]=a=>t.value.price=a)},null,512),[[p,t.value.price,void 0,{number:!0}]])]),xe,e("div",ye,[we,u(e("textarea",{name:"",id:"description",rows:"4","onUpdate:modelValue":o[7]||(o[7]=a=>t.value.description=a)},null,512),[[p,t.value.description]])]),e("div",$e,[Ue,u(e("textarea",{name:"",id:"content",rows:"4","onUpdate:modelValue":o[8]||(o[8]=a=>t.value.content=a)},null,512),[[p,t.value.content]])]),e("div",null,[u(e("input",{type:"checkbox",id:"is_enabled","onUpdate:modelValue":o[9]||(o[9]=a=>t.value.is_enabled=a),"true-value":1,"false-value":0},null,512),[[N,t.value.is_enabled]]),ke])])])]),e("div",Pe,[e("button",{type:"button",class:"m-1 px-3 py-1.5 bg-transparent text-#6c757d border-1 border-solid border-#6c757d rd hover:cursor-pointer hover:bg-#5c636a hover:text-white",onClick:o[10]||(o[10]=a=>r.value.close())},"取消"),e("button",{type:"button",class:"m-1 px-3 py-1.5 text-white bg-#0d6efd border-0 rd hover:cursor-pointer hover:bg-#0b5ed7",onClick:o[11]||(o[11]=a=>b.$emit("confirmProduct",t.value))},"確定")])])],512))}},Ce=H(Ve,[["__scopeId","data-v-b6e9f945"]]);var Ee={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"payroom",BASE_URL:"/vue2023-week7/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const Se={class:"container mx-a relative"},Te={class:"text-end mt-6"},Ie={class:"w-100% mt-6"},De=e("thead",{class:"border-b-1 border-black border-solid fw-bold text-left"},[e("tr",null,[e("th",{width:"120"}," 分類 "),e("th",null,"產品名稱"),e("th",{width:"120",class:"text-end"}," 原價 "),e("th",{width:"120",class:"text-end"}," 售價 "),e("th",{width:"100",class:"text-center"}," 是否啟用 "),e("th",{width:"120"}," 編輯 ")])],-1),Ne={class:"text-end"},Le={class:"text-end"},Re={class:"text-center"},Be={key:0,class:"text-#198754"},Me={key:1,class:"text-red"},Ae=["onClick"],Oe=["onClick"],Je={__name:"AdminProducts",setup(m){const{VITE_URL:y,VITE_PATH:w}=Ee,k=_([]),c=_(),t=_({}),r=_(!0),h=_({}),$=_(!1);function x(s=1){$.value=!0,P.get(`${y}/v2/api/${w}/admin/products?page=${s}`).then(i=>{k.value=i.data.products,h.value=i.data.pagination}).catch(i=>{f.fire({icon:"error",title:"錯誤發生",text:i.response.data.message})}).finally(()=>{$.value=!1})}function b(){c.value.dialog.showModal(),t.value={},r.value=!0}function o(s){t.value=JSON.parse(JSON.stringify(s)),r.value=!1,c.value.dialog.showModal()}function a(s){if(r.value)P.post(`${y}/v2/api/${w}/admin/product`,{data:s}).then(i=>{f.fire({title:`${i.data.message}`,icon:"success",target:"dialog",didClose:()=>{x(h.value.current_page||1)}}),c.value.dialog.close(),t.value={}}).catch(i=>{f.fire({icon:"error",target:"dialog",title:"錯誤發生",text:`${i}`})});else{const{id:i}=s;P.put(`${y}/v2/api/${w}/admin/product/${i}`,{data:s}).then(l=>{f.fire({title:`${l.data.message}`,icon:"success",didClose:()=>{x(h.value.current_page||1)}}),c.value.dialog.close(),t.value={}}).catch(l=>{f.fire({icon:"error",target:"dialog",title:"錯誤發生",text:`${l.response.data.message}`})})}}function n(s){f.fire({title:`你確定要刪除 ${s.title} 嗎?`,showCancelButton:!0,confirmButtonText:"確定",cancelButtonText:"取消"}).then(i=>{i.isConfirmed&&P.delete(`${y}/v2/api/${w}/admin/product/${s.id}`).then(l=>{f.fire({icon:"success",text:l.data.message,didClose:()=>{x(h.value.current_page||1)}})}).catch(l=>{f.fire({icon:"error",text:l.response.data.message})})})}return B(()=>{x()}),(s,i)=>(v(),g(V,null,[e("div",Se,[C(M(I),{active:$.value,"full-page":!1},null,8,["active"]),e("div",Te,[e("button",{type:"button",class:"bg-#0d6efd border-0 text-white cursor-pointer inline-block px-3 py-1.5 rd font-size-4 hover:bg-#0b5ed7",onClick:i[0]||(i[0]=l=>b())},"建立新的產品")]),e("table",Ie,[De,e("tbody",null,[(v(!0),g(V,null,E(k.value,l=>(v(),g("tr",{class:"border-b border-#DEE2E6 border-solid",key:l.id},[e("td",null,U(l.category),1),e("td",null,U(l.title),1),e("td",Ne,U(l.origin_price),1),e("td",Le,U(l.price),1),e("td",Re,[l.is_enabled?(v(),g("span",Be,"啟用")):(v(),g("span",Me,"未啟用"))]),e("td",null,[e("div",null,[e("button",{type:"button",class:"text-#0d6efd bg-transparent border-1 border-#0d6efd border-solid rd-tl rd-bl px-2 py-1 hover:bg-#0d6efd hover:text-white hover:cursor-pointer",onClick:T=>o(l)}," 編輯 ",8,Ae),e("button",{type:"button",class:"text-#dc3545 bg-transparent border-1 border-#de3545 border-solid rd-tr rd-br px-2 py-1 hover:bg-#de3545 hover:text-white hover:cursor-pointer",onClick:T=>n(l)}," 刪除 ",8,Oe)])])]))),128))])])]),C(Ce,{onConfirmProduct:a,"temp-product":t.value,"is-new":r.value,ref_key:"dialog",ref:c},null,8,["temp-product","is-new"]),k.value.length?(v(),A(j,{key:0,pages:h.value,onChangePage:x},null,8,["pages"])):O("",!0)],64))}};export{Je as default};
